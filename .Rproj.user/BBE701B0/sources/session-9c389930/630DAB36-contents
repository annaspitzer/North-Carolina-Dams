
filtered_summary <- short_summary_county %>%
  filter(CountyID != 37183) # wake has 200 dams

county_dam_distribution <- filtered_summary %>%
  count(high_hazard_count)

mean_dams <- mean(regression_county_filtered$high_hazard_count, na.rm = TRUE)
median_dams <- median(regression_county_filtered$high_hazard_count, na.rm = TRUE)
variance_dams <- var(regression_county_filtered$high_hazard_count, na.rm = TRUE)

ggplot(regression_county_filtered, aes(x = high_hazard_count)) +
  geom_histogram(binwidth = 2, fill = "steelblue", color = "black") +
  geom_vline(xintercept = mean_dams, color = "red", linetype = "dashed", linewidth = 1) +
  geom_vline(xintercept = median_dams, color = "green", linetype = "dotted", linewidth = 1) +
  annotate("text", x = mean_dams + 5, y = 10, label = paste("Mean:", round(mean_dams, 2)), color = "red") +
  annotate("text", x = median_dams + 5, y = 9, label = paste("Median:", round(median_dams, 2)), color = "green") +
  annotate("text", x = max(regression_county_filtered$high_hazard_count) * 0.7, y = 8, 
           label = paste("Variance:", round(variance_dams, 2)), color = "black") +
  labs(title = "Distribution of Counties by High Hazard Dam Count",
       x = "Number of High Hazard Dams",
       y = "Number of Counties") +
  theme_minimal()


# Install package if not already installed
install.packages("AER")

# Load library
library(AER)

# Fit a Poisson model
poisson_model <- glm(high_hazard_count ~ 1, family = poisson, data = regression_county_filtered)

# Perform the dispersion test
dispersiontest(poisson_model)
